<script>
   window.addEventListener("load", () => {
    function log(msg) {
      console.log(msg);
    }
    
    log("Window loaded, running adblock check");
    
    // Create elements programmatically
    function createOverlay(visibility = "none") {
      const enabledEl = document.createElement("div");
      enabledEl.classList.add("adb-enabled");
      
      const overlay = document.createElement("div");
      overlay.classList.add("adb-enabled-overlay");
      
      const content = document.createElement("div");
      content.classList.add("adb-enabled-content");
      
      const title = document.createElement("h2");
      title.textContent = "Ad blocker detected";
      
      const message = document.createElement("p");
      message.textContent = "Please disable your AdBlock to continue.";
      
      const continueBtn = document.createElement("button");
      continueBtn.classList.add("adb-continue-btn");
      continueBtn.textContent = "Continue without supporting (10s)";
      
      // Build DOM structure
      content.appendChild(title);
      content.appendChild(message);
      content.appendChild(continueBtn);
      overlay.appendChild(content);
      enabledEl.appendChild(overlay);
      enabledEl.style.display = visibility;
      
      // Add styles
      const styles = document.createElement("style");
      styles.textContent = `
        .adb-enabled-overlay {
          width: 100%;
          height: 100%;
          position: fixed;
          top: 0;
          left: 0;
          color: white;
          background-color: #ee3030;
          z-index: 99999;
          padding: 70px;
        }
        .adb-continue-btn {
          cursor: pointer;
          padding: 5px;
          border: 1px solid white;
          background-color: transparent;
          color: white;
          transition: 500ms;
        }
        .adb-continue-btn:hover {
          background-color: white;
          color: #ee3030;
          transition: 500ms;
        }
        body {
          margin-right: 150px;
        }
        header .r-side-nav {
          padding-right: 150px !important;
        }
      `;
      document.head.appendChild(styles);
      
      return { enabledEl, continueBtn };
    }
    
    const { enabledEl, continueBtn } = createOverlay("none");
    document.body.appendChild(enabledEl);
  
    function adBlockDetected() {
      log("adBlockDetected()");
      let ax = false;
      enabledEl.style.display = "block";
  
      // Adblock delay countdown
      let countdown = 10;
      const countdownInterval = setInterval(function() {
        countdown--;
        continueBtn.textContent = `Continue without supporting (${countdown}s)`;
        if (countdown === 0) {
          clearInterval(countdownInterval);
          continueBtn.textContent = "Continue without supporting";
        }
      }, 1000);
  
      continueBtn.addEventListener("click", (e) => {
        if (countdown === 0) {
          ax = true;
          enabledEl.style.display = "none";
        }
      });
  
      // Check if the element still exists every 750ms
      const checkInterval = setInterval(function() {
        if (!document.body.contains(enabledEl)) {
          clearInterval(checkInterval);
          const { enabledEl: newEl } = createOverlay("block");
          document.body.appendChild(newEl);
        }
      }, 750);
    }
  
    function adBlockNotDetected() {
      log("Blocks not detected");
      enabledEl.style.display = "none";
    }
  
    const REQUEST_URL = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";
    const REQUEST_CONFIG = {
      method: "HEAD",
      mode: "no-cors",
    };
  
  const checkAdsBlocked = (callback) => {
    fetch(REQUEST_URL, REQUEST_CONFIG)
        .then((response) => {
            callback(response.redirected);
        })                                  
        .catch(() => {
            callback(true);
        });
    };
  
    checkAdsBlocked((adsBlocked)=>{
        if(adsBlocked){
            adBlockDetected();
        }else{
            adBlockNotDetected();
        }
    });
  });
  </script>
